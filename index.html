<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prime Elder Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Importing Ancient/Stone style fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Playfair+Display:ital,wght@0,400;0,700;1,900&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #0a0c0f;
            color: #d1d5db;
            background-image: radial-gradient(circle at center, #1a202c 0%, #0a0c0f 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            font-family: 'Playfair Display', serif;
        }
        
        h1, h2, .dino-title {
            font-family: 'Cinzel', serif;
            letter-spacing: 0.15em;
        }

        .main-content {
            flex: 1;
        }
        .glass-panel {
            background: rgba(31, 41, 55, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        .checkbox-custom {
            width: 20px;
            height: 20px;
            cursor: pointer;
            accent-color: #10b981;
        }
        .progress-glow {
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
        }
        
        /* Styled Dropdowns */
        select {
            background: rgba(0, 0, 0, 0.6) !important;
            border: 1px solid rgba(16, 185, 129, 0.3) !important;
            color: #10b981 !important;
            font-family: 'Cinzel', serif;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%2310b981' viewBox='0 0 24 24'%3E%3Cpath d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") !important;
            background-repeat: no-repeat !important;
            background-position: right 0.5rem center !important;
            background-size: 1.5em 1.5em !important;
            padding-right: 2.5rem !important;
            cursor: pointer;
        }
        
        /* Styled Text Inputs */
        input[type="text"] {
            background: rgba(0, 0, 0, 0.6) !important;
            border: 1px solid rgba(16, 185, 129, 0.3) !important;
            color: #10b981 !important;
            font-family: 'Cinzel', serif;
            outline: none;
            transition: border-color 0.2s;
        }

        input[type="text"]:focus {
            border-color: #10b981 !important;
        }

        /* Number Button Group Styles */
        .num-btn {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(75, 85, 99, 0.4);
            color: #4b5563;
            transition: all 0.2s ease;
            font-family: 'Cinzel', serif;
            font-weight: bold;
        }
        .num-btn.active {
            background: rgba(16, 185, 129, 0.2);
            border-color: #10b981;
            color: #10b981;
            box-shadow: 0 0 10px rgba(16, 185, 129, 0.2);
        }

        .hidden-objective {
            display: none !important;
        }
        .isle-logo {
            filter: drop-shadow(0 0 12px rgba(16, 185, 129, 0.4));
            max-width: 80px;
            height: auto;
        }
        #privacy-modal, #rename-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.85);
            z-index: 50;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #0a0c0f;
        }
        ::-webkit-scrollbar-thumb {
            background: #1f2937;
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #10b981;
        }
        .social-icon {
            transition: all 0.2s ease;
            color: #9ca3af;
        }
        .social-icon:hover {
            color: #10b981;
            transform: translateY(-2px);
        }
        .dino-avatar {
            background: linear-gradient(135deg, #064e3b 0%, #022c22 100%);
            border: 2px solid #10b98144;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            text-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }
    </style>
</head>
<body class="p-2 md:p-6 lg:p-8">

    <!-- Privacy Modal -->
    <div id="privacy-modal">
        <div class="glass-panel max-w-md w-full rounded-2xl p-8 border-emerald-500/30">
            <h2 class="text-xl font-bold text-emerald-500 mb-4">Data & Privacy Notice</h2>
            <p class="text-sm text-gray-300 mb-4 leading-relaxed">
                To keep track of your dinosaur's progress, this website saves your profiles to your browser's <strong>Local Storage</strong>.
            </p>
            <ul class="text-xs text-gray-400 space-y-2 mb-6 list-disc pl-4">
                <li>No data is sent to a server.</li>
                <li>No personal information is collected.</li>
                <li>If you clear your browser cache, your progress will be lost.</li>
            </ul>
            <button onclick="acceptPrivacy()" class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-3 rounded-xl transition-all dino-title">
                I Understand
            </button>
        </div>
    </div>

    <!-- Rename Modal -->
    <div id="rename-modal">
        <div class="glass-panel max-w-sm w-full rounded-2xl p-6 border-emerald-500/30">
            <h2 class="text-[10px] font-bold uppercase tracking-widest text-emerald-500 mb-4">Edit Dino Nickname</h2>
            <input type="text" id="modal-nickname-input" placeholder="e.g. Alpha Male, Solo Run..." class="w-full rounded-lg p-3 text-sm text-emerald-400 font-bold outline-none border border-emerald-500/40 mb-6 bg-black/60">
            <div class="flex gap-3">
                <button onclick="closeRenameModal()" class="flex-1 text-gray-400 hover:text-white text-xs font-bold uppercase py-2 dino-title">Cancel</button>
                <button onclick="saveNicknameFromModal()" class="flex-1 bg-emerald-600 hover:bg-emerald-500 text-white text-xs font-bold uppercase py-2 rounded-lg transition-all dino-title">Save Name</button>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto main-content">
        <header class="flex flex-row items-center justify-between mb-8 gap-4">
            <div class="flex items-center gap-6">
                <img src="https://www.theisle-game.com/templates/yootheme/cache/8f/The-Isle-Skull-copy-8f195f17.webp" alt="The Isle Skull Logo" class="isle-logo">
                <div class="hidden md:block h-12 w-px bg-emerald-500/30"></div>
                <div>
                    <h1 class="text-xl md:text-3xl font-black text-emerald-500 uppercase leading-tight">Prime Elder Tracker</h1>
                    <p class="text-gray-500 text-[10px] uppercase font-bold tracking-[0.2em] opacity-80">Reach all goals before 75% growth</p>
                </div>
            </div>
            
            <div class="flex items-center gap-3">
                <div class="text-right hidden sm:block">
                    <span id="counter" class="text-2xl font-mono text-emerald-400">0/5</span>
                    <p class="text-[10px] uppercase font-bold text-gray-500 tracking-widest">Run Progress</p>
                </div>
                <div id="dino-icon-placeholder" class="w-16 h-16 md:w-20 md:h-20 dino-avatar rounded-xl overflow-hidden shrink-0">
                    <span id="dino-letter" class="text-3xl md:text-4xl font-bold text-emerald-400">?</span>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            <!-- Left Column -->
            <div class="lg:col-span-4 space-y-4">
                <div class="glass-panel rounded-2xl p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h2 class="text-[10px] font-bold uppercase tracking-widest text-gray-500">Active Profile</h2>
                        <button onclick="createNewProfile()" class="text-emerald-500 hover:text-emerald-400 text-[10px] font-bold uppercase transition-colors tracking-widest">+ New Dino</button>
                    </div>
                    
                    <div class="flex gap-2 mb-4">
                        <select id="profile-select" onchange="switchProfile()" class="flex-1 rounded-lg p-2 text-sm outline-none font-bold">
                        </select>
                        <button onclick="openRenameModal()" class="p-2 bg-emerald-900/20 text-emerald-500 rounded-lg hover:bg-emerald-900/40 transition-colors" title="Rename Dino">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/></svg>
                        </button>
                        <button onclick="deleteCurrentProfile()" class="p-2 bg-red-900/30 text-red-500 rounded-lg hover:bg-red-900/50 transition-colors" title="Delete Profile">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/><path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/></svg>
                        </button>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <label class="block text-[10px] uppercase font-bold text-gray-500 mb-1 ml-1 tracking-widest">Species</label>
                            <select id="dino-species" onchange="updateSpecies()" class="w-full rounded-lg p-2 text-sm outline-none">
                                <option value="" disabled>Select Species...</option>
                                <optgroup label="Carnivores">
                                    <option value="Ceratosaurus">Ceratosaurus</option>
                                    <option value="Deinosuchus">Deinosuchus</option>
                                    <option value="Dilophosaurus">Dilophosaurus</option>
                                    <option value="Herrerasaurus">Herrerasaurus</option>
                                    <option value="Omniraptor">Omniraptor</option>
                                    <option value="Pteranodon">Pteranodon</option>
                                    <option value="Troodon">Troodon</option>
                                    <option value="Tyrannosaurus">Tyrannosaurus Rex</option>
                                </optgroup>
                                <optgroup label="Omnivores">
                                    <option value="Beipiaosaurus">Beipiaosaurus</option>
                                    <option value="Gallimimus">Gallimimus</option>
                                </optgroup>
                                <optgroup label="Herbivores">
                                    <option value="Diabloceratops">Diabloceratops</option>
                                    <option value="Dryosaurus">Dryosaurus</option>
                                    <option value="Hypsilophodon">Hypsilophodon</option>
                                    <option value="Pachycephalosaurus">Pachycephalosaurus</option>
                                    <option value="Stegosaurus">Stegosaurus</option>
                                    <option value="Tenontosaurus">Tenontosaurus</option>
                                    <option value="Triceratops">Triceratops</option>
                                </optgroup>
                            </select>
                        </div>
                        <div>
                            <label class="block text-[10px] uppercase font-bold text-gray-500 mb-1 ml-1 tracking-widest">Status & Server</label>
                            <div class="flex gap-2">
                                <select id="life-status" onchange="updateProgress()" class="w-1/3 rounded-lg p-2 text-sm outline-none">
                                    <option value="Alive">Alive</option>
                                    <option value="Dead">Dead</option>
                                    <option value="Stored">Stored</option>
                                </select>
                                <input type="text" id="server-name" placeholder="SERVER NAME..." oninput="updateProgress()" class="w-2/3 rounded-lg p-2 text-sm outline-none uppercase font-bold tracking-widest">
                            </div>
                        </div>
                    </div>
                    
                    <button id="manual-save-btn" onclick="manualSave()" class="w-full mt-4 flex items-center justify-center gap-2 bg-emerald-900/40 hover:bg-emerald-800/60 text-emerald-400 text-[10px] font-bold uppercase tracking-widest py-2.5 rounded-xl border border-emerald-500/20 transition-all duration-300 dino-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M11 2H9v3h2z"/><path d="M1.5 0h11.586a1.5 1.5 0 0 1 1.06.44l1.415 1.414A1.5 1.5 0 0 1 16 2.914V14.5a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 14.5v-13A1.5 1.5 0 0 1 1.5 0M1 1.5v13a.5.5 0 0 0 .5.5H2v-4.5A1.5 1.5 0 0 1 3.5 9h9a1.5 1.5 0 0 1 1.5 1.5V15h.5a.5.5 0 0 0 .5-.5V2.914a.5.5 0 0 0-.146-.353l-1.415-1.415A.5.5 0 0 0 13.086 1H13v4.5A1.5 1.5 0 0 1 11.5 7h-7A1.5 1.5 0 0 1 3 5.5V1H1.5a.5.5 0 0 0-.5.5m3 4.5h7a.5.5 0 0 0 .5-.5V1H4v4.5a.5.5 0 0 0 .5.5M3 15h10v-4.5a.5.5 0 0 0-.5-.5h-9a.5.5 0 0 0-.5.5z"/></svg>
                        <span>Save to Browser</span>
                    </button>
                </div>

                <div class="glass-panel rounded-2xl p-4">
                    <h2 class="text-[10px] font-bold uppercase tracking-widest text-gray-500 mb-3 text-center">Spawn Type</h2>
                    <div class="flex p-1 bg-black/40 rounded-xl border border-gray-700/50">
                        <button onclick="setSpawn('spawned')" id="btn-spawned" class="flex-1 py-1.5 text-xs font-bold rounded-lg transition-all duration-200 uppercase dino-title">Spawn</button>
                        <button onclick="setSpawn('hatched')" id="btn-hatched" class="flex-1 py-1.5 text-xs font-bold rounded-lg transition-all duration-200 uppercase dino-title">Hatch</button>
                    </div>
                </div>

                <div class="glass-panel rounded-2xl p-4">
                    <div class="w-full bg-gray-800 rounded-full h-3 overflow-hidden border border-gray-700 mb-2">
                        <div id="progress-bar" class="h-full bg-emerald-500 transition-all duration-500 ease-out w-0 progress-glow"></div>
                    </div>
                    <p id="status-msg" class="text-center text-[11px] font-bold uppercase tracking-[0.2em] text-gray-500 dino-title">Select objectives...</p>
                    
                    <button onclick="resetCurrentProfile()" class="w-full mt-4 text-red-900/60 hover:text-red-500 transition-colors uppercase tracking-[0.3em] font-bold text-[9px] py-1 border border-red-900/20 rounded-lg dino-title">Reset Progress</button>
                </div>
            </div>

            <!-- Right Column -->
            <div class="lg:col-span-8">
                <div class="glass-panel rounded-2xl overflow-hidden h-full">
                    <div id="checklist-container" class="divide-y divide-gray-700/50">
                        <div id="item-sanctuary"></div>
                        <div id="hatched-hidden-group" class="grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-gray-700/50">
                            <div class="divide-y divide-gray-700/50">
                                <div id="item-diet"></div>
                                <div id="item-infertility"></div>
                                <div id="item-spasms"></div>
                                <div id="item-mass"></div>
                            </div>
                            <div class="divide-y divide-gray-700/50">
                                <!-- Migration Row -->
                                <div class="p-4 bg-white/5">
                                    <div class="flex items-start">
                                        <div class="pt-1">
                                            <input type="checkbox" id="migration-check" class="checkbox-custom rounded border-gray-600 bg-gray-700 pointer-events-none opacity-50">
                                        </div>
                                        <div class="ml-3 flex-1">
                                            <span class="block text-sm font-bold text-gray-200 dino-title tracking-wider">Migration Goals (2 Required)</span>
                                            <div id="mz-selector" class="mt-2 flex items-center gap-2">
                                                <button onclick="setZoneCount('mz', 0)" class="num-btn px-2.5 py-1 text-xs rounded border active" data-val="0">0</button>
                                                <button onclick="setZoneCount('mz', 1)" class="num-btn px-2.5 py-1 text-xs rounded border" data-val="1">1</button>
                                                <button onclick="setZoneCount('mz', 2)" class="num-btn px-2.5 py-1 text-xs rounded border" data-val="2">2</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- Patrol Row -->
                                <div class="p-4 bg-white/5">
                                    <div class="flex items-start">
                                        <div class="pt-1">
                                            <input type="checkbox" id="patrol-check" class="checkbox-custom rounded border-gray-600 bg-gray-700 pointer-events-none opacity-50">
                                        </div>
                                        <div class="ml-3 flex-1">
                                            <span class="block text-sm font-bold text-gray-200 dino-title tracking-wider">Patrol Goals (4 Required)</span>
                                            <div id="pz-selector" class="mt-2 flex items-center gap-2">
                                                <button onclick="setZoneCount('pz', 0)" class="num-btn px-2.5 py-1 text-xs rounded border active" data-val="0">0</button>
                                                <button onclick="setZoneCount('pz', 1)" class="num-btn px-2.5 py-1 text-xs rounded border" data-val="1">1</button>
                                                <button onclick="setZoneCount('pz', 2)" class="num-btn px-2.5 py-1 text-xs rounded border" data-val="2">2</button>
                                                <button onclick="setZoneCount('pz', 3)" class="num-btn px-2.5 py-1 text-xs rounded border" data-val="3">3</button>
                                                <button onclick="setZoneCount('pz', 4)" class="num-btn px-2.5 py-1 text-xs rounded border" data-val="4">4</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div id="item-nest"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Social Footer -->
    <footer class="mt-16 pt-8 pb-12 border-t border-gray-800/50 max-w-6xl mx-auto w-full">
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
            <div class="text-center md:text-left order-2 md:order-1">
                <p class="text-[10px] uppercase font-bold text-gray-500 tracking-widest mb-1">Developer</p>
                <a href="https://github.com/Peinful_" target="_blank" class="text-sm font-bold text-gray-300 hover:text-emerald-400 transition-colors flex items-center justify-center md:justify-start gap-1">
                    Made with <span class="text-red-500">â™¥</span> by Pein
                </a>
            </div>

            <div class="flex justify-center gap-6 order-1 md:order-2">
                <a href="https://x.com/PeinfulZ" target="_blank" class="social-icon" title="X (Twitter)">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16"><path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/></svg>
                </a>
                <a href="https://www.twitch.tv/PeinfulZ" target="_blank" class="social-icon" title="Twitch">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2H3v16h5v4l4-4h5l4-4V2zm-10 9V7m5 4V7"></path></svg>
                </a>
                <a href="https://www.youtube.com/@PeinfulZ" target="_blank" class="social-icon" title="YouTube">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>
                </a>
                <a href="https://discord.gg/p345CKHdCF" target="_blank" class="social-icon" title="Discord">
                    <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" viewBox="0 0 16 16"><path d="M13.545 2.907a13.227 13.227 0 0 0-3.257-1.011.05.05 0 0 0-.052.025c-.141.25-.297.577-.406.833a12.19 12.19 0 0 0-3.658 0 8.258 8.258 0 0 0-.412-.833.051.051 0 0 0-.052-.025c-1.125.194-2.22.534-3.257 1.011a.041.041 0 0 0-.021.018C.356 6.024-.213 9.047.066 12.032c.001.014.01.028.021.037a13.276 13.276 0 0 0 3.995 2.02.05.05 0 0 0 .056-.019c.308-.42.582-.863.818-1.329a.05.05 0 0 0-.01-.059.051.051 0 0 0-.018-.011 8.875 8.875 0 0 1-1.248-.595.05.05 0 0 1-.02-.066.051.051 0 0 1 .015-.019c.084-.063.168-.129.248-.195a.05.05 0 0 1 .051-.007c2.619 1.196 5.454 1.196 8.041 0a.052.052 0 0 1 .053.007c.08.066.164.132.248.195a.051.051 0 0 1-.004.085 8.254 8.254 0 0 1-1.249.594.05.05 0 0 0-.03.03.052.052 0 0 0 .003.041c.24.465.515.909.817 1.329a.05.05 0 0 0 .056.019 13.235 13.235 0 0 0 4.001-2.02.049.049 0 0 0 .021-.037c.334-3.451-.559-6.449-2.366-9.106a.034.034 0 0 0-.02-.019Zm-8.198 7.307c-.789 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.45.73 1.438 1.613 0 .888-.637 1.612-1.438 1.612Zm5.316 0c-.788 0-1.438-.724-1.438-1.612 0-.889.637-1.613 1.438-1.613.807 0 1.451.73 1.438 1.613 0 .888-.631 1.612-1.438 1.612Z"/></svg>
                </a>
            </div>

            <div class="text-center md:text-right order-3">
                <p class="text-[9px] text-emerald-500/80 font-bold uppercase tracking-widest leading-relaxed">
                    Disclaimer: This is a fan-made tool. Not affiliated with Afterthought LLC. Data is saved locally in your browser.
                </p>
            </div>
        </div>
    </footer>

    <script>
        const standardObjectives = [
            { id: 'sanctuary', text: 'Visit Sanctuary', sub: 'Stay for ~10s.' },
            { id: 'diet', text: 'Perfect Diet', sub: 'Balance all nutrients.' },
            { id: 'infertility', text: 'Avoid Infertility', sub: 'Nutrients kept active.' },
            { id: 'spasms', text: 'Avoid Spasms', sub: 'No cannibalism.' },
            { id: 'nest', text: 'Nesting Goal', sub: 'Raise a hatchling to 50%.' },
            { id: 'mass', text: 'Mass Migration', sub: 'Visit primary zone.' }
        ];

        const createDefaultProfileData = (species = 'Pachycephalosaurus') => ({
            name: species, 
            nickname: '', 
            spawnType: 'spawned', 
            mz: 0, 
            pz: 0, 
            server: '', 
            status: 'Alive', 
            checks: {
                'infertility': true,
                'spasms': true
            }
        });

        let profiles = JSON.parse(localStorage.getItem('isle_elder_profiles_v13')) || {
            'default': createDefaultProfileData()
        };
        let activeId = localStorage.getItem('isle_elder_active_id_v13') || 'default';

        function init() {
            if (!localStorage.getItem('privacy_accepted')) {
                document.getElementById('privacy-modal').style.display = 'flex';
            }
            renderChecklist();
            renderProfileList();
            loadProfile(activeId);
        }

        function acceptPrivacy() {
            localStorage.setItem('privacy_accepted', 'true');
            document.getElementById('privacy-modal').style.display = 'none';
        }

        function manualSave() {
            saveCurrentState();
            const btn = document.getElementById('manual-save-btn');
            const originalContent = btn.innerHTML;
            btn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425z"/></svg><span>Saved!</span>`;
            btn.classList.replace('bg-emerald-900/40', 'bg-emerald-600');
            btn.classList.replace('text-emerald-400', 'text-white');
            setTimeout(() => {
                btn.innerHTML = originalContent;
                btn.classList.replace('bg-emerald-600', 'bg-emerald-900/40');
                btn.classList.replace('text-white', 'text-emerald-400');
            }, 2000);
        }

        function openRenameModal() {
            const p = profiles[activeId];
            document.getElementById('modal-nickname-input').value = p.nickname || '';
            document.getElementById('rename-modal').style.display = 'flex';
            document.getElementById('modal-nickname-input').focus();
        }

        function closeRenameModal() {
            document.getElementById('rename-modal').style.display = 'none';
        }

        function saveNicknameFromModal() {
            const newName = document.getElementById('modal-nickname-input').value;
            profiles[activeId].nickname = newName;
            saveAll();
            renderProfileList();
            closeRenameModal();
        }

        function updateDinoPlaceholder(species) {
            const letter = species ? species.charAt(0).toUpperCase() : '?';
            document.getElementById('dino-letter').innerText = letter;
        }

        function renderProfileList() {
            const select = document.getElementById('profile-select');
            select.innerHTML = Object.keys(profiles).map(id => {
                const p = profiles[id];
                const statusEmoji = p.status === 'Dead' ? 'ðŸ’€' : p.status === 'Stored' ? 'ðŸ“¦' : 'ðŸ¦–';
                const displayName = p.nickname ? `${p.nickname} (${p.name})` : p.name;
                return `<option value="${id}" ${id === activeId ? 'selected' : ''}>${statusEmoji} ${displayName}</option>`;
            }).join('');
        }

        function renderChecklist() {
            standardObjectives.forEach(obj => {
                const el = document.getElementById(`item-${obj.id}`);
                if (!el) return;
                el.innerHTML = `
                    <label class="flex items-start p-4 hover:bg-white/5 transition-colors cursor-pointer group">
                        <div class="pt-1">
                            <input type="checkbox" id="${obj.id}" class="checkbox-custom rounded border-gray-600 bg-gray-700" onchange="updateProgress()">
                        </div>
                        <div class="ml-3">
                            <span class="block text-sm font-bold text-gray-200 group-hover:text-emerald-400 transition-colors dino-title tracking-widest">${obj.text}</span>
                            <span class="block text-[10px] text-gray-500 uppercase font-medium tracking-widest">${obj.sub}</span>
                        </div>
                    </label>
                `;
            });
        }

        function switchProfile() {
            saveCurrentState();
            activeId = document.getElementById('profile-select').value;
            localStorage.setItem('isle_elder_active_id_v13', activeId);
            loadProfile(activeId);
        }

        function createNewProfile() {
            const species = document.getElementById('dino-species').value || "Pachycephalosaurus";
            const id = 'p_' + Date.now();
            profiles[id] = createDefaultProfileData(species);
            activeId = id
